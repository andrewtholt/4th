5 REM "BATTLE"
7 REM "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
10 REM -- BATTLE WRITTEN BY RAY WESTERGARD  10/70
20 REM COPYRIGHT 1971 BY THE REGENTS OF THE UNIV. OF CALIF.
30 REM PRODUCED AT THE LAWRENCE HALL OF SCIENCE, BERKELEY
40 REM F(6,6),H(6,6),A(4),B(4),C(6),L(3)
50 FOR X=1 TO 6
51 FOR Y=1 TO 6
52 @(X*6+Y)=0
53 NEXT Y
54 NEXT X
60 FOR I=1 TO 3
70 N=4-I
80 FOR J=1 TO 2
90 A=RND(6)+1
100 B=RND(6)+1
110 D=RND(4)+1
120 IF @(A*6+B)>0 THEN GOTO 90
130 M=0
140 GOTO (150*(D=1)) + (340*(D=2)) + (550*(D=3)) + (740*(D=4))
150 @(103+1)=B
160 @(103+2)=7:@(103+3)=7
170 K=1
180 IF M>1 THEN GOTO 240
190 IF @(103+K)=6 THEN GOTO 230
200 IF @(6*A+@(103+K)+1)>0 THEN GOTO 230
210 @(103+K+1)=@(103+K)+1
220 GOTO 280
230 M=2
240 IF (@(103+1)<@(103+2)) * (@(103+1)<@(103+3)) THEN Z=@(103+1)
242 IF (@(103+2)<@(103+1)) * (@(103+2)<@(103+3)) THEN Z=@(103+2)
244 IF (@(103+3)<@(103+1)) * (@(103+3)<@(103+2)) THEN Z=@(103+3)
250 IF Z=1 THEN GOTO 90
260 IF @(A*6+Z-1)>0 THEN GOTO 90
270 @(103+K+1)=Z-1
280 K=K+1 : IF K<N+1 GOTO 180
290 @(A*6+B)=9-2*I-J
300 FOR K=1 TO N
310 @(A*6+@(103+K+1))=@(6*A+B)
320 NEXT K
330 GOTO 990
340 @(98+1)=A
350 @(103+1)=B
360 @(98+2)=0:@(98+3)=0:@(103+2)=0:@(103+3)=0
370 K=1
380 IF M>1 THEN GOTO 460
390 IF (@(98+K)=1) + (@(103+K)=1) THEN GOTO 450
400 IF  @(6*(@(98+K)-1)+@(103+K)-1) > 0 THEN GOTO 450
410 IF (@(6*(@(98+K)-1)+@(103+K))>0) * (@(6*(@(98+K)-1)+@(103+K))=@(6*@(98+K)+@(103+K)-1)) THEN GOTO 450
420 @(98+K+1)=@(98+K)-1
430 @(103+K+1)=@(103+K)-1
440 GOTO 530
450 M=2
460 IF (@(98+1)>@(98+2)) * (@(98+1)>@(98+3)) THEN O=@(98+1)
462 IF (@(98+2)>@(98+1)) * (@(98+2)>@(98+3)) THEN O=@(98+2)
464 IF (@(98+3)>@(98+1)) * (@(98+3)>@(98+2)) THEN O=@(98+3)
470 IF (@(103+1)>@(103+2)) * (@(103+1)>@(103+3)) THEN Q=@(103+1)
474 IF (@(103+2)>@(103+1)) * (@(103+2)>@(103+3)) THEN Q=@(103+2)
476 IF (@(103+3)>@(103+1)) * (@(103+3)>@(103+2)) THEN Q=@(103+3)
480 IF (O=6) + (Q=6) THEN GOTO 90
490 IF @(6*(O+1)+Q+1)>0 THEN GOTO 90
500 IF (@(6*O+Q+1)>0) * (@(6*O+Q+1)=@(6*(O+1)+Q)) THEN GOTO 90
510 @(98+K+1)=O+1
520 @(103+K+1)=Q+1
530 K=K+1 : IF K<N+1 GOTO 380
540 GOTO 950
550 @(98+1)=A
560 @(98+2)=7:@(98+3)=7
570 K=1
580 IF M>1 THEN GOTO 640
590 IF @(98+K)=6 THEN GOTO 630
600 IF @(6*(@(98+K)+1)+B)>0 THEN GOTO 630
610 @(98+K+1)=@(98+K)+1
620 GOTO 680
630 M=2
640 IF (@(98+1)<@(98+2)) * (@(98+1)<@(98+3)) THEN Z=@(98+1)
642 IF (@(98+2)<@(98+1)) * (@(98+2)<@(98+3)) THEN Z=@(98+2)
644 IF (@(98+3)<@(98+1)) * (@(98+3)<@(98+2)) THEN Z=@(98+3)
650 IF Z=1 THEN GOTO 90
660 IF @(6*(Z-1)+B)>0 THEN GOTO 90
670 @(98+K+1)=Z-1
680 K=K+1 : IF K<N+1 GOTO 580
690 @(6*A+B)=9-2*I-J
700 FOR K=1 TO N
710 @(6*@(98+K+1)+B)=@(6*A+B)
720 NEXT K
730 GOTO 990
740 @(98+1)=A
750 @(103+1)=B
760 @(98+2)=7:@(98+3)=7
770 @(103+2)=0:@(103+3)=0
780 K=1
790 IF M>1 THEN GOTO 870
800 IF (@(98+K)=6) + (@(103+K)=1) THEN GOTO 860
810 IF @(6*(@(98+K)+1)+@(103+K)-1)>0 THEN GOTO 860
820 IF (@(6*(@(98+K)+1)+@(103+K))>0) * (@(6*(@(98+K)+1)+@(103+K))=@(6*(@(98+K))+@(103+K)-1)) THEN GOTO 860
830 @(98+K+1)=@(98+K)+1
840 @(103+K+1)=@(103+K)-1
850 GOTO 940
860 M=2
870 IF (@(98+1)<@(98+2)) * (@(98+1)<@(98+3)) THEN O=@(98+1)
872 IF (@(98+2)<@(98+1)) * (@(98+2)<@(98+3)) THEN O=@(98+2)
874 IF (@(98+3)<@(98+1)) * (@(98+3)<@(98+2)) THEN O=@(98+3)
880 IF (@(103+1)>@(103+2)) * (@(103+1)>@(103+3)) THEN Q=@(103+1)
882 IF (@(103+2)>@(103+1)) * (@(103+2)>@(103+3)) THEN Q=@(103+2)
884 IF (@(103+3)>@(103+1)) * (@(103+3)>@(103+2)) THEN Q=@(103+3)
890 IF (O=1) + (Q=6) THEN GOTO 90
900 IF @(6*(O-1)+Q+1)>0 THEN GOTO 90
910 IF (@(6*O+Q+1)>0) * (@(6*O+Q+1)=@(6*(O-1)+Q)) THEN GOTO 90
920 @(98+K+1)=O-1
930 @(103+K+1)=Q+1
940 K=K+1 : IF K<N+1 GOTO 790
950 @(6*A+B)=9-2*I-J
960 FOR K=1 TO N
970 @(6*(@(98+K+1))+@(103+K+1))=@(A*6+B)
980 NEXT K
990 NEXT J
1000 NEXT I
1010 PRINT
1020 PRINT "THE FOLLOWING CODE OF THE BAD GUYS' FLEET DISPOSITION"
1030 PRINT "HAS BEEN CAPTURED BUT NOT DECODED:"
1040 PRINT
1050 FOR I=1 TO 6
1051 FOR J=1 TO 6
1052 @(49+6*I+J)=@(J*6+I)
1053 NEXT J
1054 NEXT I
1060 FOR I=1 TO 6
1061 FOR J=1 TO 6
1062 PRINT @(49+6*I+J);
1063 NEXT J
1064 PRINT
1065 NEXT I
1070 PRINT
1080 PRINT "DE-CODE IT AND USE IT IF YOU CAN"
1090 PRINT "BUT KEEP THE DE-CODING METHOD A SECRET."
1100 PRINT
1110 FOR I=1 TO 6
1111 FOR J=1 TO 6
1112 @(49+6*I+J)=0
1113 NEXT J
1114 NEXT I
1120 FOR I=1 TO 3
1121 @(115+I)=0
1122 NEXT I
1130 @(108+1)=2:@(108+2)=2
1140 @(108+3)=1:@(108+4)=1
1150 @(108+5)=0:@(108+6)=0
1160 S=0:H=0
1170 PRINT "START GAME"
1180 INPUT X : INPUT Y
1190 IF ((X>0) * (X<7) * X) # ABS(X) THEN GOTO 1210
1200 IF ((Y>0) * (Y<7) * Y) = ABS(Y) THEN GOTO 1230
1210 PRINT "INVALID INPUT.  TRY AGAIN."
1220 GOTO 1180
1230 R=7-Y
1240 C=X
1250 IF @(6*R+C)>0 THEN GOTO 1290
1260 S=S+1
1270 PRINT "SPLASH!  TRY AGAIN."
1280 GOTO 1180
1290 IF @(108+@(6*R+C))<4 THEN GOTO 1340
1300 PRINT "THERE USED TO BE A SHIP AT THAT POINT, BUT YOU SUNK IT."
1310 PRINT "SPLASH!  TRY AGAIN."
1320 S=S+1
1330 GOTO 1180
1340 IF @(49+6*R+C)>0 THEN GOTO 1420
1350 H=H+1
1360 @(49+6*R+C)=@(6*R+C)
1370 PRINT "A DIRECT HIT ON SHIP NUMBER ";@(6*R+C)
1380 @(108+@(6*R+C))=@(108+@(6*R+C))+1
1390 IF @(108+@(6*R+C))>3 THEN GOTO 1470
1400 PRINT "TRY AGAIN."
1410 GOTO 1180
1420 PRINT "YOU ALREADY PUT A HOLE IN SHIP NUMBER ";@(6*R+C);
1430 PRINT "AT THAT POINT."
1440 PRINT "SPLASH!  TRY AGAIN."
1450 S=S+1
1460 GOTO 1180
1470 @(115+((@(6*R+C)-1)/2)+1)=@(115+((@(6*R+C)-1)/2)+1)+1
1480 PRINT "AND YOU SUNK IT.  HURRAH FOR THE GOOD GUYS."
1490 PRINT "SO FAR, THE BAD GUYS HAVE LOST"
1500 PRINT @(115+1);" DESTROYER(S), ";@(115+2);" CRUISER(S), AND ";
1510 PRINT @(115+3);" AIRCRAFT CARRIER(S)."
1520 PRINT "YOUR CURRENT SPLASH/HIT RATIO IS ";S/H
1530 IF (@(115+1)+@(115+2)+@(115+3))<6 THEN GOTO 1180
1540 PRINT
1550 PRINT "YOU HAVE TOTALLY WIPED OUT THE BAD GUYS' FLEET"
1560 PRINT "WITH A FINAL SPLASH/HIT RATIO OF ";S/H
1570 IF S/H>0 THEN GOTO 1590
1580 PRINT "CONGRATULATIONS -- A DIRECT HIT EVERY TIME."
1590 PRINT
1600 PRINT "****************************"
1610 PRINT
1620 GOTO 50
1630 END